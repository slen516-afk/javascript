<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>è¶…è¤‡é›œç·´ç¿’ç¶²é </title>
  <style>
    :root {
      --bg: #f4f4f5;
      --bg-elevated: #ffffff;
      --text: #111827;
      --muted: #6b7280;
      --accent: #3b82f6;
      --accent-soft: rgba(59, 130, 246, 0.12);
      --border: #e5e7eb;
      --danger: #ef4444;
      --success: #22c55e;
      --shadow-soft: 0 10px 25px rgba(15, 23, 42, 0.08);
      --radius-xl: 18px;
    }

    /* æ·±è‰²æ¨¡å¼åˆ‡æ› */
    .dark {
      --bg: #020617;
      --bg-elevated: #020617;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --accent: #60a5fa;
      --accent-soft: rgba(96, 165, 250, 0.15);
      --border: #1f2937;
      --shadow-soft: 0 18px 45px rgba(0, 0, 0, 0.6);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #1d4ed8 0, transparent 55%),
        var(--bg);
      color: var(--text);
      min-height: 100vh;
      padding-bottom: 4rem;
    }

    .app-shell {
      max-width: 1120px;
      margin: 1.5rem auto 0;
      padding: 1.5rem;
      border-radius: 24px;
      background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.12),
          rgba(255, 255, 255, 0.03)
        );
      backdrop-filter: blur(24px);
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .brand-logo {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      background: conic-gradient(
        from 220deg,
        #3b82f6,
        #ec4899,
        #f97316,
        #22c55e,
        #3b82f6
      );
      display: flex;
      align-items: center;
      justify-content: center;
      color: #f9fafb;
      font-weight: 700;
      letter-spacing: 0.05em;
      box-shadow: 0 10px 30px rgba(59, 130, 246, 0.6);
    }

    .brand-text h1 {
      font-size: 1.35rem;
      font-weight: 700;
      letter-spacing: 0.03em;
    }

    .brand-text p {
      font-size: 0.86rem;
      color: var(--muted);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    button,
    .btn {
      border: none;
      cursor: pointer;
      font: inherit;
    }

    .btn {
      padding: 0.45rem 0.85rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.02);
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
      font-size: 0.85rem;
      color: var(--muted);
      transition: all 0.18s ease;
      backdrop-filter: blur(10px);
    }

    .btn.primary {
      background: linear-gradient(135deg, #3b82f6, #6366f1);
      border-color: transparent;
      color: #f9fafb;
      box-shadow: 0 10px 30px rgba(37, 99, 235, 0.5);
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 8px 18px rgba(15, 23, 42, 0.16);
      border-color: rgba(148, 163, 184, 0.6);
    }

    .btn.primary:hover {
      transform: translateY(-1px) scale(1.01);
      box-shadow: 0 18px 40px rgba(37, 99, 235, 0.7);
    }

    nav {
      display: flex;
      gap: 0.25rem;
      flex-wrap: wrap;
      margin-bottom: 1.25rem;
      padding: 0.3rem;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.04);
    }

    nav a {
      flex: 1 0 auto;
      text-align: center;
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      font-size: 0.85rem;
      text-decoration: none;
      color: var(--muted);
      transition: all 0.16s ease;
      white-space: nowrap;
    }

    nav a.active,
    nav a:hover {
      background: var(--accent-soft);
      color: var(--accent);
    }

    main {
      display: grid;
      grid-template-columns: 2.2fr 1.6fr;
      gap: 1.25rem;
    }

    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
      }
    }

    .column {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }

    .card {
      background: rgba(15, 23, 42, 0.04);
      border-radius: var(--radius-xl);
      padding: 1rem 1.1rem;
      border: 1px solid rgba(148, 163, 184, 0.18);
      backdrop-filter: blur(16px);
    }

    .card-header {
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      margin-bottom: 0.75rem;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.03em;
    }

    .card-subtitle {
      font-size: 0.8rem;
      color: var(--muted);
    }

    /* å„€è¡¨æ¿å€ */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.75rem;
      margin-bottom: 0.75rem;
    }

    .stat-pill {
      padding: 0.65rem 0.7rem;
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      background: rgba(15, 23, 42, 0.06);
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .stat-label {
      font-size: 0.8rem;
      color: var(--muted);
    }

    .stat-value {
      font-size: 0.95rem;
      font-weight: 600;
    }

    .clock {
      font-variant-numeric: tabular-nums;
      font-size: 1.1rem;
    }

    .quote {
      font-size: 0.9rem;
      color: var(--muted);
      padding: 0.75rem 0.8rem;
      border-radius: 0.9rem;
      background: rgba(15, 23, 42, 0.05);
      border: 1px dashed rgba(148, 163, 184, 0.6);
      margin-top: 0.5rem;
    }

    /* å¾…è¾¦æ¸…å–® */
    #todoForm {
      display: flex;
      gap: 0.55rem;
      margin-bottom: 0.65rem;
    }

    input[type="text"],
    input[type="email"],
    input[type="number"] {
      width: 100%;
      padding: 0.5rem 0.7rem;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(15, 23, 42, 0.03);
      color: var(--text);
      font-size: 0.9rem;
      outline: none;
      transition: border-color 0.16s ease, box-shadow 0.16s ease,
        background 0.16s ease;
    }

    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="number"]:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.3);
      background: rgba(15, 23, 42, 0.06);
    }

    .btn.icon {
      padding-inline: 0.65rem;
      font-size: 1rem;
    }

    .todo-filters {
      display: flex;
      gap: 0.4rem;
      margin-bottom: 0.5rem;
      flex-wrap: wrap;
    }

    .chip {
      padding: 0.25rem 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.8rem;
      color: var(--muted);
      background: transparent;
      cursor: pointer;
      transition: all 0.16s ease;
    }

    .chip.active,
    .chip:hover {
      background: var(--accent-soft);
      border-color: var(--accent);
      color: var(--accent);
    }

    #todoList {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 0.45rem;
      max-height: 260px;
      overflow-y: auto;
      padding-right: 0.25rem;
    }

    .todo-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.45rem 0.6rem;
      border-radius: 0.8rem;
      background: rgba(15, 23, 42, 0.06);
    }

    .todo-item span {
      flex: 1;
      font-size: 0.9rem;
    }

    .todo-item.done span {
      text-decoration: line-through;
      color: var(--muted);
      opacity: 0.8;
    }

    .todo-item button {
      border-radius: 999px;
      border: none;
      padding: 0.25rem 0.55rem;
      font-size: 0.75rem;
      cursor: pointer;
      background: rgba(15, 23, 42, 0.05);
      color: var(--muted);
      transition: all 0.16s ease;
    }

    .todo-item button:hover {
      background: rgba(148, 163, 184, 0.3);
      color: #111827;
    }

    .todo-item button.delete {
      color: var(--danger);
    }

    /* ç•ªèŒ„é˜ */
    .timer-display {
      font-variant-numeric: tabular-nums;
      font-size: 2.1rem;
      font-weight: 700;
      text-align: center;
      margin: 0.5rem 0 0.75rem;
    }

    .timer-controls {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
    }

    .timer-controls .btn {
      font-size: 0.85rem;
      padding-inline: 0.9rem;
    }

    .timer-status {
      text-align: center;
      font-size: 0.85rem;
      color: var(--muted);
      margin-top: 0.4rem;
    }

    /* Gallery */
    .gallery-filters {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-bottom: 0.7rem;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 0.75rem;
    }

    .gallery-item {
      border-radius: 0.9rem;
      overflow: hidden;
      background: rgba(15, 23, 42, 0.06);
      border: 1px solid rgba(148, 163, 184, 0.4);
      display: flex;
      flex-direction: column;
    }

    .gallery-thumb {
      aspect-ratio: 4 / 3;
      background-size: cover;
      background-position: center;
    }

    .gallery-body {
      padding: 0.45rem 0.6rem 0.55rem;
    }

    .gallery-title {
      font-size: 0.82rem;
      font-weight: 500;
      margin-bottom: 0.25rem;
    }

    .gallery-tag {
      display: inline-flex;
      align-items: center;
      padding: 0.1rem 0.5rem;
      border-radius: 999px;
      font-size: 0.75rem;
      background: rgba(148, 163, 184, 0.2);
      color: var(--muted);
    }

    /* è¨­å®š */
    #settingsForm {
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .field-group {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    label {
      font-size: 0.82rem;
      color: var(--muted);
    }

    .helper {
      font-size: 0.78rem;
      color: var(--muted);
    }

    .error {
      font-size: 0.78rem;
      color: var(--danger);
    }

    .success-msg {
      font-size: 0.8rem;
      color: var(--success);
      margin-top: 0.3rem;
    }

    /* Modal */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.65);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }

    .modal-backdrop.visible {
      display: flex;
    }

    .modal {
      background: var(--bg-elevated);
      border-radius: 20px;
      padding: 1.2rem 1.4rem;
      width: min(420px, 90vw);
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border);
      animation: pop 0.18s ease-out;
    }

    @keyframes pop {
      from {
        transform: scale(0.96) translateY(6px);
        opacity: 0;
      }
      to {
        transform: scale(1) translateY(0);
        opacity: 1;
      }
    }

    .modal header {
      margin-bottom: 0.7rem;
    }

    .modal header h2 {
      font-size: 1.1rem;
    }

    .modal header button {
      border-radius: 999px;
      padding: 0.25rem 0.6rem;
      background: rgba(15, 23, 42, 0.06);
      color: var(--muted);
    }

    .modal-content {
      font-size: 0.9rem;
      color: var(--muted);
      line-height: 1.5;
    }

    .modal-footer {
      margin-top: 0.9rem;
      display: flex;
      justify-content: flex-end;
    }

    .pill-badge {
      padding: 0.2rem 0.6rem;
      border-radius: 999px;
      font-size: 0.75rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      color: var(--muted);
      display: inline-flex;
      gap: 0.3rem;
      align-items: center;
    }

    /* scroll bar å¾®èª¿æ•´ */
    ::-webkit-scrollbar {
      width: 6px;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(148, 163, 184, 0.7);
      border-radius: 999px;
    }
  </style>
</head>
<body>
  <div class="app-shell">
    <header>
      <div class="brand">
        <div class="brand-logo">LAB</div>
        <div class="brand-text">
          <h1>Front-End Playground</h1>
          <p>ä¸€å€‹ç·´ç¿’ DOMã€äº‹ä»¶ã€localStorageã€æ¨£å¼çš„å°å¯¦é©—å®¤</p>
        </div>
      </div>
      <div class="header-actions">
        <button id="themeToggle" class="btn">ğŸŒ™ æ·±è‰²æ¨¡å¼</button>
        <button id="aboutBtn" class="btn primary">â” é—œæ–¼é€™å€‹é é¢</button>
      </div>
    </header>

    <nav>
      <a href="#dashboard" class="active">Dashboard</a>
      <a href="#todoSection">å¾…è¾¦æ¸…å–®</a>
      <a href="#timerSection">ç•ªèŒ„é˜</a>
      <a href="#gallerySection">Gallery</a>
      <a href="#settingsSection">è¨­å®š</a>
    </nav>

    <main>
      <!-- å·¦åŠéƒ¨ -->
      <div class="column">
        <!-- Dashboard -->
        <section id="dashboard" class="card">
          <div class="card-header">
            <div>
              <div class="card-title">ä»Šå¤©çš„ç‹€æ…‹</div>
              <div class="card-subtitle">ç”¨ä¸€å€‹å°å°å„€è¡¨æ¿è¿½è¹¤ä½ çš„ä¸€å¤©</div>
            </div>
            <span class="pill-badge">
              <span id="dayOfWeek">é€±ï¼Ÿ</span>
              <span id="dateStr"></span>
            </span>
          </div>

          <div class="stats-grid">
            <div class="stat-pill">
              <div class="stat-label">ç¾åœ¨æ™‚é–“</div>
              <div class="stat-value clock" id="clock">--:--:--</div>
            </div>
            <div class="stat-pill">
              <div class="stat-label">å®Œæˆçš„å¾…è¾¦</div>
              <div class="stat-value" id="completedCount">0</div>
            </div>
            <div class="stat-pill">
              <div class="stat-label">ç•ªèŒ„æ¬¡æ•¸</div>
              <div class="stat-value" id="pomodoroCount">0</div>
            </div>
          </div>

          <div class="quote" id="quote">
            ã€Œå¯«ç¨‹å¼å°±æ˜¯ä¸åœ debugï¼Œç›´åˆ° bug è®Šæˆ featureã€‚ã€
          </div>
        </section>

        <!-- å¾…è¾¦æ¸…å–® -->
        <section id="todoSection" class="card">
          <div class="card-header">
            <div class="card-title">å¾…è¾¦æ¸…å–®</div>
            <div class="card-subtitle">ä½¿ç”¨ localStorage ä¿å­˜ä½ çš„ä»»å‹™</div>
          </div>

          <form id="todoForm">
            <input
              type="text"
              id="todoInput"
              placeholder="ä»Šå¤©è¦å®Œæˆä»€éº¼ï¼Ÿä¾‹å¦‚ï¼šç·´ 30 åˆ†é˜ JavaScript"
            />
            <button class="btn icon primary" type="submit">ï¼‹</button>
          </form>

          <div class="todo-filters">
            <button class="chip active" data-filter="all">å…¨éƒ¨</button>
            <button class="chip" data-filter="active">æœªå®Œæˆ</button>
            <button class="chip" data-filter="done">å·²å®Œæˆ</button>
          </div>

          <ul id="todoList"></ul>
        </section>
      </div>

      <!-- å³åŠéƒ¨ -->
      <div class="column">
        <!-- ç•ªèŒ„é˜ -->
        <section id="timerSection" class="card">
          <div class="card-header">
            <div class="card-title">ç•ªèŒ„é˜</div>
            <div class="card-subtitle">é è¨­ 25 åˆ†é˜ï¼Œä½ å¯ä»¥åœ¨è¨­å®šä¸­èª¿æ•´</div>
          </div>

          <div class="timer-display" id="timerDisplay">25:00</div>

          <div class="timer-controls">
            <button class="btn primary" id="timerStart">â–¶ é–‹å§‹</button>
            <button class="btn" id="timerPause">â¸ æš«åœ</button>
            <button class="btn" id="timerReset">âŸ² é‡è¨­</button>
          </div>

          <div class="timer-status" id="timerStatus">è¨ˆæ™‚å°šæœªé–‹å§‹</div>
        </section>

        <!-- Gallery -->
        <section id="gallerySection" class="card">
          <div class="card-header">
            <div class="card-title">å°å° Galleryï¼ˆç”¨ data-attribute ç¯©é¸ï¼‰</div>
            <div class="card-subtitle">ç´” CSS å‡åœ–ç¤ºï¼Œç„¡éœ€ä¸‹è¼‰åœ–ç‰‡æª”</div>
          </div>

          <div class="gallery-filters">
            <button class="chip active" data-gallery-filter="all">å…¨éƒ¨</button>
            <button class="chip" data-gallery-filter="work">å­¸ç¿’ / å·¥ä½œ</button>
            <button class="chip" data-gallery-filter="life">ç”Ÿæ´»</button>
            <button class="chip" data-gallery-filter="fun">Fun</button>
          </div>

          <div class="gallery-grid" id="galleryGrid">
            <article class="gallery-item" data-category="work">
              <div
                class="gallery-thumb"
                style="background-image: linear-gradient(135deg, #2563eb, #4f46e5)"
              ></div>
              <div class="gallery-body">
                <div class="gallery-title">Code Session</div>
                <span class="gallery-tag">å­¸ç¿’ / å·¥ä½œ</span>
              </div>
            </article>

            <article class="gallery-item" data-category="life">
              <div
                class="gallery-thumb"
                style="background-image: linear-gradient(135deg, #16a34a, #22c55e)"
              ></div>
              <div class="gallery-body">
                <div class="gallery-title">Morning Walk</div>
                <span class="gallery-tag">ç”Ÿæ´»</span>
              </div>
            </article>

            <article class="gallery-item" data-category="fun">
              <div
                class="gallery-thumb"
                style="background-image: linear-gradient(135deg, #e11d48, #f97316)"
              ></div>
              <div class="gallery-body">
                <div class="gallery-title">Gaming Time</div>
                <span class="gallery-tag">Fun</span>
              </div>
            </article>

            <article class="gallery-item" data-category="work">
              <div
                class="gallery-thumb"
                style="background-image: linear-gradient(135deg, #06b6d4, #0ea5e9)"
              ></div>
              <div class="gallery-body">
                <div class="gallery-title">Data Visual</div>
                <span class="gallery-tag">å­¸ç¿’ / å·¥ä½œ</span>
              </div>
            </article>

            <article class="gallery-item" data-category="life">
              <div
                class="gallery-thumb"
                style="background-image: linear-gradient(135deg, #a855f7, #ec4899)"
              ></div>
              <div class="gallery-body">
                <div class="gallery-title">Coffee Break</div>
                <span class="gallery-tag">ç”Ÿæ´»</span>
              </div>
            </article>
          </div>
        </section>

        <!-- è¨­å®š -->
        <section id="settingsSection" class="card">
          <div class="card-header">
            <div class="card-title">è¨­å®š</div>
            <div class="card-subtitle">ç¤ºç¯„è¡¨å–® + æ­£è¦è¡¨é”å¼é©—è­‰ + localStorage</div>
          </div>

          <form id="settingsForm" novalidate>
            <div class="field-group">
              <label for="nameInput">æš±ç¨±</label>
              <input
                type="text"
                id="nameInput"
                placeholder="æƒ³æ€éº¼ç¨±å‘¼ä½ ï¼Ÿ"
              />
              <p class="helper">æœƒé¡¯ç¤ºåœ¨å‹µå¿—å¥å­è£¡ã€‚</p>
            </div>

            <div class="field-group">
              <label for="emailInput">Emailï¼ˆç°¡å–®é©—è­‰ï¼‰</label>
              <input
                type="email"
                id="emailInput"
                placeholder="you@example.com"
              />
              <p class="helper">
                ä½¿ç”¨æ­£è¦è¡¨é”å¼æª¢æŸ¥åŸºæœ¬æ ¼å¼ï¼šè‹±æ•¸å­— + @ + ç¶²åŸŸã€‚
              </p>
              <p class="error" id="emailError" style="display: none">
                Email æ ¼å¼å¥½åƒæ€ªæ€ªçš„ï¼Œå†æª¢æŸ¥çœ‹çœ‹ ğŸ™
              </p>
            </div>

            <div class="field-group">
              <label for="focusMinutesInput">å–®æ¬¡å°ˆæ³¨æ™‚é–“ï¼ˆåˆ†é˜ï¼‰</label>
              <input
                type="number"
                id="focusMinutesInput"
                min="5"
                max="90"
                step="5"
                value="25"
              />
              <p class="helper">
                æœƒå½±éŸ¿ç•ªèŒ„é˜çš„é•·åº¦ã€‚å»ºè­° 25 åˆ†é˜ï¼Œä¼‘æ¯ 5 åˆ†é˜ã€‚
              </p>
            </div>

            <button type="submit" class="btn primary">ğŸ’¾ å„²å­˜è¨­å®š</button>
            <p class="success-msg" id="settingsSaved" style="display: none">
              å·²å„²å­˜è¨­å®šï¼
            </p>
          </form>
        </section>
      </div>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal-backdrop" id="aboutModal">
    <div class="modal">
      <header>
        <div class="brand-text">
          <h2>é€™å€‹é é¢åœ¨å¹¹å˜›ï¼Ÿ</h2>
          <p>å°ˆé–€æ‹¿ä¾†ç·´å‰ç«¯çš„ã€Œè¿·ä½ å¯¦é©—å®¤ã€ã€‚</p>
        </div>
        <button id="modalCloseBtn">âœ•</button>
      </header>
      <div class="modal-content">
        <p>
          é€™å€‹å–®é ç¤ºç¯„äº†å¾ˆå¤šå‰ç«¯åŸºæœ¬åŠŸï¼šDOM æ“ä½œã€äº‹ä»¶ã€localStorageã€æ­£è¦è¡¨é”å¼ã€
          data-* attributeã€æ·±è‰²æ¨¡å¼åˆ‡æ›ã€å¹³æ»‘æ²å‹•ç­‰ç­‰ã€‚
        </p>
        <p style="margin-top: 0.6rem">
          ä½ å¯ä»¥éš¨ä¾¿æ”¹ HTML / CSS / JS çœ‹æœƒç™¼ç”Ÿä»€éº¼äº‹ï¼Œç„¶å¾Œåœ¨ DevTools è§€å¯Ÿã€‚
        </p>
      </div>
      <div class="modal-footer">
        <button class="btn primary" id="modalOkBtn">å¥½ï¼Œå»ç©ç©çœ‹ï¼</button>
      </div>
    </div>
  </div>

  <script>
    // ========= å·¥å…·å°å‡½å¼ =========
    function $(selector, scope = document) {
      return scope.querySelector(selector);
    }
    function $all(selector, scope = document) {
      return Array.from(scope.querySelectorAll(selector));
    }

    // ========= ä¸»é¡Œåˆ‡æ› =========
    const themeToggleBtn = $("#themeToggle");
    const root = document.documentElement;

    function applyTheme(theme) {
      if (theme === "dark") {
        root.classList.add("dark");
        themeToggleBtn.textContent = "â˜€ï¸ æ·ºè‰²æ¨¡å¼";
      } else {
        root.classList.remove("dark");
        themeToggleBtn.textContent = "ğŸŒ™ æ·±è‰²æ¨¡å¼";
      }
    }

    const savedTheme = localStorage.getItem("theme");
    applyTheme(savedTheme || "light");

    themeToggleBtn.addEventListener("click", () => {
      const isDark = root.classList.toggle("dark");
      const newTheme = isDark ? "dark" : "light";
      localStorage.setItem("theme", newTheme);
      applyTheme(newTheme);
    });

    // ========= å°è¦½åˆ—å¹³æ»‘æ²å‹• =========
    const navLinks = $all("nav a");
    navLinks.forEach((link) => {
      link.addEventListener("click", (event) => {
        event.preventDefault();
        const targetId = link.getAttribute("href");
        const section = document.querySelector(targetId);
        if (!section) return;
        section.scrollIntoView({ behavior: "smooth", block: "start" });

        navLinks.forEach((l) => l.classList.remove("active"));
        link.classList.add("active");
      });
    });

    // ========= Dashboard: æ™‚é–“ + æ—¥æœŸ + éš¨æ©Ÿå¥å­ =========
    const clockEl = $("#clock");
    const dayOfWeekEl = $("#dayOfWeek");
    const dateStrEl = $("#dateStr");
    const quoteEl = $("#quote");

    const quotes = [
      "ã€ŒæˆåŠŸä¸æ˜¯é‹æ°£ï¼Œæ˜¯æ¯å¤©ä¸€é»é»çš„ç´¯ç©ã€‚ã€",
      "ã€Œå¯«ä¸å‡ºä¾†æ™‚ï¼Œå…ˆå¯«çˆ›ï¼Œå†æ…¢æ…¢è®Šå¥½ã€‚ã€",
      "ã€Œç¨‹å¼æœƒé¨™ä½ ï¼Œbug ä¸æœƒã€‚ã€",
      "ã€Œèƒ½è¢«è‡ªå·±æ˜¨å¤©çš„ç¨‹å¼ç¢¼å™å¿ƒåˆ°ï¼Œä»£è¡¨ä½ é€²æ­¥äº†ã€‚ã€",
      "ã€Œåˆ¥æ€•æ…¢ï¼Œåªæ€•ä½ åœã€‚ã€"
    ];

    function updateClock() {
      const now = new Date();
      const h = String(now.getHours()).padStart(2, "0");
      const m = String(now.getMinutes()).padStart(2, "0");
      const s = String(now.getSeconds()).padStart(2, "0");
      clockEl.textContent = `${h}:${m}:${s}`;

      const days = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];
      dayOfWeekEl.textContent = days[now.getDay()];

      const y = now.getFullYear();
      const mon = String(now.getMonth() + 1).padStart(2, "0");
      const d = String(now.getDate()).padStart(2, "0");
      dateStrEl.textContent = `${y}/${mon}/${d}`;
    }
    updateClock();
    setInterval(updateClock, 1000);

    function updateQuote() {
      const name = ($("#nameInput").value || "ä½ ").trim();
      const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
      quoteEl.textContent = randomQuote.replace("ä½ ", name);
    }
    updateQuote();
    setInterval(updateQuote, 1000 * 60 * 3); // æ¯ 3 åˆ†é˜æ›ä¸€æ¬¡

    // ========= å¾…è¾¦æ¸…å–® =========
    const todoForm = $("#todoForm");
    const todoInput = $("#todoInput");
    const todoListEl = $("#todoList");
    const filterButtons = $all(".todo-filters .chip");
    const completedCountEl = $("#completedCount");

    let todos = [];

    function loadTodos() {
      try {
        const raw = localStorage.getItem("todos");
        if (raw) {
          todos = JSON.parse(raw);
        }
      } catch (err) {
        console.error("è¼‰å…¥ todos å¤±æ•—:", err);
        todos = [];
      }
    }

    function saveTodos() {
      localStorage.setItem("todos", JSON.stringify(todos));
    }

    function renderTodos(filter = "all") {
      todoListEl.innerHTML = "";
      const filtered = todos.filter((todo) => {
        if (filter === "active") return !todo.done;
        if (filter === "done") return todo.done;
        return true;
      });

      filtered.forEach((todo) => {
        const li = document.createElement("li");
        li.className = "todo-item" + (todo.done ? " done" : "");
        li.dataset.id = todo.id;

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.checked = todo.done;
        checkbox.addEventListener("change", () => toggleTodo(todo.id));

        const span = document.createElement("span");
        span.textContent = todo.text;

        const delBtn = document.createElement("button");
        delBtn.textContent = "åˆªé™¤";
        delBtn.classList.add("delete");
        delBtn.addEventListener("click", () => deleteTodo(todo.id));

        li.appendChild(checkbox);
        li.appendChild(span);
        li.appendChild(delBtn);
        todoListEl.appendChild(li);
      });

      const doneCount = todos.filter((t) => t.done).length;
      completedCountEl.textContent = doneCount;
    }

    function addTodo(text) {
      const todo = {
        id: Date.now().toString(),
        text,
        done: false
      };
      todos.unshift(todo);
      saveTodos();
      const activeFilterBtn = filterButtons.find((btn) =>
        btn.classList.contains("active")
      );
      const currentFilter =
        activeFilterBtn?.dataset.filter || "all";
      renderTodos(currentFilter);
    }

    function toggleTodo(id) {
      todos = todos.map((t) =>
        t.id === id ? { ...t, done: !t.done } : t
      );
      saveTodos();
      const activeFilterBtn = filterButtons.find((btn) =>
        btn.classList.contains("active")
      );
      const currentFilter =
        activeFilterBtn?.dataset.filter || "all";
      renderTodos(currentFilter);
    }

    function deleteTodo(id) {
      todos = todos.filter((t) => t.id !== id);
      saveTodos();
      const activeFilterBtn = filterButtons.find((btn) =>
        btn.classList.contains("active")
      );
      const currentFilter =
        activeFilterBtn?.dataset.filter || "all";
      renderTodos(currentFilter);
    }

    todoForm.addEventListener("submit", (event) => {
      event.preventDefault();
      const text = todoInput.value.trim();
      if (!text) return;
      addTodo(text);
      todoInput.value = "";
    });

    filterButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        filterButtons.forEach((b) => b.classList.remove("active"));
        btn.classList.add("active");
        renderTodos(btn.dataset.filter);
      });
    });

    loadTodos();
    renderTodos();

    // ========= ç•ªèŒ„é˜ =========
    const timerDisplay = $("#timerDisplay");
    const timerStartBtn = $("#timerStart");
    const timerPauseBtn = $("#timerPause");
    const timerResetBtn = $("#timerReset");
    const timerStatus = $("#timerStatus");
    const pomodoroCountEl = $("#pomodoroCount");
    let focusMinutes = Number($("#focusMinutesInput").value) || 25;

    let timerSeconds = focusMinutes * 60;
    let timerInterval = null;
    let pomodoroCount =
      Number(localStorage.getItem("pomodoroCount") || "0");

    function updateTimerDisplay() {
      const minutes = String(Math.floor(timerSeconds / 60)).padStart(
        2,
        "0"
      );
      const seconds = String(timerSeconds % 60).padStart(2, "0");
      timerDisplay.textContent = `${minutes}:${seconds}`;
    }

    function setTimerStatus(message) {
      timerStatus.textContent = message;
    }

    function startTimer() {
      if (timerInterval) return; // already running
      if (timerSeconds <= 0) {
        timerSeconds = focusMinutes * 60;
      }
      setTimerStatus("å°ˆæ³¨ä¸­ï¼ŒåŠ æ²¹ï¼");
      timerInterval = setInterval(() => {
        timerSeconds--;
        updateTimerDisplay();
        if (timerSeconds <= 0) {
          clearInterval(timerInterval);
          timerInterval = null;
          setTimerStatus("æ™‚é–“åˆ°ï¼ä¼‘æ¯ä¸€ä¸‹å§ ğŸ‘");
          pomodoroCount++;
          localStorage.setItem(
            "pomodoroCount",
            String(pomodoroCount)
          );
          pomodoroCountEl.textContent = pomodoroCount;
          // ç°¡å–®æç¤º
          alert("ç•ªèŒ„çµæŸï¼è¨˜å¾—èµ·ä¾†å‹•ä¸€å‹•ã€‚");
        }
      }, 1000);
    }

    function pauseTimer() {
      if (!timerInterval) return;
      clearInterval(timerInterval);
      timerInterval = null;
      setTimerStatus("å·²æš«åœã€‚");
    }

    function resetTimer() {
      clearInterval(timerInterval);
      timerInterval = null;
      timerSeconds = focusMinutes * 60;
      updateTimerDisplay();
      setTimerStatus("è¨ˆæ™‚å°šæœªé–‹å§‹");
    }

    timerStartBtn.addEventListener("click", startTimer);
    timerPauseBtn.addEventListener("click", pauseTimer);
    timerResetBtn.addEventListener("click", resetTimer);

    pomodoroCountEl.textContent = pomodoroCount;
    updateTimerDisplay();

    // ========= Gallery ç¯©é¸ï¼ˆdata-attributeï¼‰ =========
    const galleryFilterButtons = $all(
      "[data-gallery-filter]"
    );
    const galleryItems = $all(".gallery-item");

    galleryFilterButtons.forEach((btn) => {
      btn.addEventListener("click", () => {
        galleryFilterButtons.forEach((b) =>
          b.classList.remove("active")
        );
        btn.classList.add("active");
        const filter = btn.dataset.galleryFilter;
        galleryItems.forEach((item) => {
          const cat = item.dataset.category;
          const show = filter === "all" || cat === filter;
          item.style.display = show ? "flex" : "none";
        });
      });
    });

    // ========= è¨­å®šè¡¨å–®ï¼ˆæ­£è¦è¡¨é”å¼é©—è­‰ + localStorageï¼‰ =========
    const settingsForm = $("#settingsForm");
    const nameInput = $("#nameInput");
    const emailInput = $("#emailInput");
    const focusMinutesInput = $("#focusMinutesInput");
    const emailError = $("#emailError");
    const settingsSavedMsg = $("#settingsSaved");

    function loadSettings() {
      try {
        const raw = localStorage.getItem("settings");
        if (!raw) return;
        const settings = JSON.parse(raw);
        if (settings.name) nameInput.value = settings.name;
        if (settings.email) emailInput.value = settings.email;
        if (settings.focusMinutes) {
          focusMinutesInput.value = settings.focusMinutes;
          focusMinutes = Number(settings.focusMinutes);
          timerSeconds = focusMinutes * 60;
          updateTimerDisplay();
        }
      } catch (err) {
        console.error("è¼‰å…¥ settings å¤±æ•—:", err);
      }
    }
    loadSettings();

    // ç°¡å–® Email æ­£è¦è¡¨é”å¼
    const emailRegex =
      /^[a-zA-Z0-9._-]+@[a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+$/;

    settingsForm.addEventListener("submit", (event) => {
      event.preventDefault();
      const name = nameInput.value.trim();
      const email = emailInput.value.trim();
      const focus = Number(focusMinutesInput.value);

      if (email && !emailRegex.test(email)) {
        emailError.style.display = "block";
        return;
      } else {
        emailError.style.display = "none";
      }

      const settings = {
        name,
        email,
        focusMinutes: focus
      };
      localStorage.setItem("settings", JSON.stringify(settings));

      focusMinutes = focus || 25;
      timerSeconds = focusMinutes * 60;
      updateTimerDisplay();

      settingsSavedMsg.style.display = "block";
      setTimeout(() => {
        settingsSavedMsg.style.display = "none";
      }, 1800);

      // ç«‹åˆ»æ›´æ–°å‹µå¿—å¥å­ä¸­çš„åå­—
      updateQuote();
    });

    // ========= Modal =========
    const aboutBtn = $("#aboutBtn");
    const aboutModal = $("#aboutModal");
    const modalCloseBtn = $("#modalCloseBtn");
    const modalOkBtn = $("#modalOkBtn");

    function openModal() {
      aboutModal.classList.add("visible");
    }
    function closeModal() {
      aboutModal.classList.remove("visible");
    }

    aboutBtn.addEventListener("click", openModal);
    modalCloseBtn.addEventListener("click", closeModal);
    modalOkBtn.addEventListener("click", closeModal);
    aboutModal.addEventListener("click", (event) => {
      if (event.target === aboutModal) {
        closeModal();
      }
    });
  </script>
</body>
</html>
